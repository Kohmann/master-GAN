we are running from this directory: /cluster/home/eivinkoh/master-GAN/COTGAN/jobs
 the name of the job is: cotgan_tune
Th job ID is 17129675
The job was run on these nodes: idun-04-01
Number of nodes: 1
We are using 1 cores
We are using 1 cores per node
Total of 1 cores
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: numpy in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from -r requirements.txt (line 1)) (1.23.5)
Requirement already satisfied: torch in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from -r requirements.txt (line 2)) (1.13.0)
Requirement already satisfied: matplotlib in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from -r requirements.txt (line 3)) (3.6.2)
Requirement already satisfied: neptune-client in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from -r requirements.txt (line 4)) (0.16.16)
Requirement already satisfied: umap-learn in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from -r requirements.txt (line 5)) (0.5.3)
Requirement already satisfied: geomloss in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from -r requirements.txt (line 6)) (0.2.5)
Requirement already satisfied: scipy in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from -r requirements.txt (line 7)) (1.9.3)
Requirement already satisfied: typing-extensions in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from torch->-r requirements.txt (line 2)) (4.4.0)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from torch->-r requirements.txt (line 2)) (11.7.99)
Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from torch->-r requirements.txt (line 2)) (8.5.0.96)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from torch->-r requirements.txt (line 2)) (11.7.99)
Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from torch->-r requirements.txt (line 2)) (11.10.3.66)
Requirement already satisfied: contourpy>=1.0.1 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from matplotlib->-r requirements.txt (line 3)) (1.0.6)
Requirement already satisfied: pyparsing>=2.2.1 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from matplotlib->-r requirements.txt (line 3)) (2.4.7)
Requirement already satisfied: pillow>=6.2.0 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from matplotlib->-r requirements.txt (line 3)) (9.3.0)
Requirement already satisfied: cycler>=0.10 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from matplotlib->-r requirements.txt (line 3)) (0.11.0)
Requirement already satisfied: packaging>=20.0 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from matplotlib->-r requirements.txt (line 3)) (20.4)
Requirement already satisfied: fonttools>=4.22.0 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from matplotlib->-r requirements.txt (line 3)) (4.38.0)
Requirement already satisfied: python-dateutil>=2.7 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from matplotlib->-r requirements.txt (line 3)) (2.8.1)
Requirement already satisfied: kiwisolver>=1.0.1 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from matplotlib->-r requirements.txt (line 3)) (1.4.4)
Requirement already satisfied: future>=0.17.1 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (0.18.2)
Requirement already satisfied: swagger-spec-validator>=2.7.4 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (3.0.3)
Requirement already satisfied: requests-oauthlib>=1.0.0 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (1.3.1)
Requirement already satisfied: GitPython>=2.0.8 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (3.1.29)
Requirement already satisfied: requests>=2.20.0 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (2.24.0)
Requirement already satisfied: pandas in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (1.5.2)
Requirement already satisfied: click>=7.0 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (7.1.2)
Requirement already satisfied: oauthlib>=2.1.0 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (3.2.2)
Requirement already satisfied: urllib3 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (1.25.11)
Requirement already satisfied: six>=1.12.0 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (1.15.0)
Requirement already satisfied: PyJWT in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (2.6.0)
Requirement already satisfied: psutil in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (5.7.2)
Requirement already satisfied: boto3>=1.16.0 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (1.26.60)
Requirement already satisfied: websocket-client!=1.0.0,>=0.35.0 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (1.5.0)
Requirement already satisfied: bravado<12.0.0,>=11.0.0 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from neptune-client->-r requirements.txt (line 4)) (11.0.3)
Requirement already satisfied: numba>=0.49 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from umap-learn->-r requirements.txt (line 5)) (0.56.4)
Requirement already satisfied: pynndescent>=0.5 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from umap-learn->-r requirements.txt (line 5)) (0.5.8)
Requirement already satisfied: scikit-learn>=0.22 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from umap-learn->-r requirements.txt (line 5)) (1.2.1)
Requirement already satisfied: tqdm in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from umap-learn->-r requirements.txt (line 5)) (4.64.1)
Requirement already satisfied: setuptools in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from nvidia-cuda-runtime-cu11==11.7.99->torch->-r requirements.txt (line 2)) (50.3.0)
Requirement already satisfied: wheel in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from nvidia-cuda-runtime-cu11==11.7.99->torch->-r requirements.txt (line 2)) (0.35.1)
Requirement already satisfied: pyyaml in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from swagger-spec-validator>=2.7.4->neptune-client->-r requirements.txt (line 4)) (6.0)
Requirement already satisfied: jsonschema in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from swagger-spec-validator>=2.7.4->neptune-client->-r requirements.txt (line 4)) (3.2.0)
Requirement already satisfied: gitdb<5,>=4.0.1 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from GitPython>=2.0.8->neptune-client->-r requirements.txt (line 4)) (4.0.9)
Requirement already satisfied: idna<3,>=2.5 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from requests>=2.20.0->neptune-client->-r requirements.txt (line 4)) (2.10)
Requirement already satisfied: certifi>=2017.4.17 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from requests>=2.20.0->neptune-client->-r requirements.txt (line 4)) (2020.6.20)
Requirement already satisfied: chardet<4,>=3.0.2 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from requests>=2.20.0->neptune-client->-r requirements.txt (line 4)) (3.0.4)
Requirement already satisfied: pytz>=2020.1 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from pandas->neptune-client->-r requirements.txt (line 4)) (2020.1)
Requirement already satisfied: jmespath<2.0.0,>=0.7.1 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from boto3>=1.16.0->neptune-client->-r requirements.txt (line 4)) (1.0.1)
Requirement already satisfied: s3transfer<0.7.0,>=0.6.0 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from boto3>=1.16.0->neptune-client->-r requirements.txt (line 4)) (0.6.0)
Requirement already satisfied: botocore<1.30.0,>=1.29.60 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from boto3>=1.16.0->neptune-client->-r requirements.txt (line 4)) (1.29.60)
Requirement already satisfied: msgpack in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from bravado<12.0.0,>=11.0.0->neptune-client->-r requirements.txt (line 4)) (1.0.0)
Requirement already satisfied: simplejson in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from bravado<12.0.0,>=11.0.0->neptune-client->-r requirements.txt (line 4)) (3.17.2)
Requirement already satisfied: monotonic in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from bravado<12.0.0,>=11.0.0->neptune-client->-r requirements.txt (line 4)) (1.6)
Requirement already satisfied: bravado-core>=5.16.1 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from bravado<12.0.0,>=11.0.0->neptune-client->-r requirements.txt (line 4)) (5.17.1)
Requirement already satisfied: llvmlite<0.40,>=0.39.0dev0 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from numba>=0.49->umap-learn->-r requirements.txt (line 5)) (0.39.1)
Requirement already satisfied: importlib-metadata; python_version < "3.9" in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from numba>=0.49->umap-learn->-r requirements.txt (line 5)) (5.0.0)
Requirement already satisfied: joblib>=0.11 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from pynndescent>=0.5->umap-learn->-r requirements.txt (line 5)) (1.2.0)
Requirement already satisfied: threadpoolctl>=2.0.0 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from scikit-learn>=0.22->umap-learn->-r requirements.txt (line 5)) (2.1.0)
Requirement already satisfied: attrs>=17.4.0 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from jsonschema->swagger-spec-validator>=2.7.4->neptune-client->-r requirements.txt (line 4)) (20.2.0)
Requirement already satisfied: pyrsistent>=0.14.0 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from jsonschema->swagger-spec-validator>=2.7.4->neptune-client->-r requirements.txt (line 4)) (0.17.3)
Requirement already satisfied: smmap<6,>=3.0.1 in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from gitdb<5,>=4.0.1->GitPython>=2.0.8->neptune-client->-r requirements.txt (line 4)) (5.0.0)
Requirement already satisfied: jsonref in /cluster/home/eivinkoh/.local/lib/python3.8/site-packages (from bravado-core>=5.16.1->bravado<12.0.0,>=11.0.0->neptune-client->-r requirements.txt (line 4)) (1.1.0)
Requirement already satisfied: zipp>=0.5 in /cluster/apps/eb/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from importlib-metadata; python_version < "3.9"->numba>=0.49->umap-learn->-r requirements.txt (line 5)) (3.3.0)
torch.cuda.get_device_name(): Tesla V100-PCIE-32GB
dataset: twosolitons
Loading dataset: Two Solitons
RAW data: (1000, 360, 360), MB: 518.4
	Downsampled:(1000, 30, 120), MB: 14.4
RAW data: (1000, 360, 360), MB: 518.4
	Downsampled:(1000, 30, 120), MB: 14.4
RAW data: (1000, 360, 360), MB: 518.4
	Downsampled:(1000, 30, 120), MB: 14.4
Concatenated data with shape (3000, 30, 120) and size: 43.2 MB
dataset: twosolitons
Loading dataset: Two Solitons
RAW data: (1000, 360, 360), MB: 518.4
	Downsampled:(1000, 30, 120), MB: 14.4
RAW data: (1000, 360, 360), MB: 518.4
	Downsampled:(1000, 30, 120), MB: 14.4
RAW data: (1000, 360, 360), MB: 518.4
	Downsampled:(1000, 30, 120), MB: 14.4
Concatenated data with shape (3000, 30, 120) and size: 43.2 MB
Num real train samples: 1920
Num real test  samples: 1920
https://app.neptune.ai/kohmann/COTGAN/e/COT-414
Using use_opt_scheduler: True
Epoch: 0, G_loss: 0, D_loss: 0:   0%|          | 0/600 [00:00<?, ?it/s]Epoch: 0, G: 255.9518, D: 255.9120:   0%|          | 0/600 [00:20<?, ?it/s]Epoch: 0, G: 255.9518, D: 255.9120:   0%|          | 1/600 [00:21<3:30:41, 21.10s/it]Epoch: 1, G: 218.7290, D: 218.6957:   0%|          | 1/600 [00:40<3:30:41, 21.10s/it]Epoch: 1, G: 218.7290, D: 218.6957:   0%|          | 2/600 [00:41<3:25:12, 20.59s/it]Epoch: 2, G: 249.8219, D: 249.7938:   0%|          | 2/600 [01:01<3:25:12, 20.59s/it]Epoch: 2, G: 249.8219, D: 249.7938:   0%|          | 3/600 [01:02<3:28:34, 20.96s/it]Epoch: 3, G: 367.4836, D: 367.4577:   0%|          | 3/600 [01:21<3:28:34, 20.96s/it]Epoch: 3, G: 367.4836, D: 367.4577:   1%|          | 4/600 [01:22<3:23:45, 20.51s/it]Epoch: 4, G: 334.0542, D: 334.0304:   1%|          | 4/600 [01:42<3:23:45, 20.51s/it]Epoch: 4, G: 334.0542, D: 334.0304:   1%|          | 5/600 [01:43<3:26:29, 20.82s/it]Epoch: 5, G: 247.2490, D: 247.2252:   1%|          | 5/600 [02:04<3:26:29, 20.82s/it]Epoch: 5, G: 247.2490, D: 247.2252:   1%|          | 6/600 [02:05<3:28:10, 21.03s/it]Epoch: 6, G: 211.0467, D: 211.0234:   1%|          | 6/600 [02:23<3:28:10, 21.03s/it]Epoch: 6, G: 211.0467, D: 211.0234:   1%|          | 7/600 [02:24<3:23:06, 20.55s/it]Epoch: 7, G: 212.4848, D: 212.4614:   1%|          | 7/600 [02:44<3:23:06, 20.55s/it]Epoch: 7, G: 212.4848, D: 212.4614:   1%|▏         | 8/600 [02:45<3:23:45, 20.65s/it]Epoch: 8, G: 296.4554, D: 296.4325:   1%|▏         | 8/600 [03:06<3:23:45, 20.65s/it]Epoch: 8, G: 296.4554, D: 296.4325:   2%|▏         | 9/600 [03:07<3:28:07, 21.13s/it]Epoch: 9, G: 166.1349, D: 166.1120:   2%|▏         | 9/600 [03:28<3:28:07, 21.13s/it]Epoch: 9, G: 166.1349, D: 166.1120:   2%|▏         | 10/600 [03:29<3:28:19, 21.19s/it]Epoch: 10, G: 158.4381, D: 158.4148:   2%|▏         | 10/600 [03:48<3:28:19, 21.19s/it]Epoch: 10, G: 158.4381, D: 158.4148:   2%|▏         | 11/600 [03:50<3:26:35, 21.04s/it]Epoch: 11, G: 175.4077, D: 175.3851:   2%|▏         | 11/600 [04:12<3:26:35, 21.04s/it]Epoch: 11, G: 175.4077, D: 175.3851:   2%|▏         | 12/600 [04:13<3:32:24, 21.67s/it]Epoch: 12, G: 167.2987, D: 167.2759:   2%|▏         | 12/600 [04:33<3:32:24, 21.67s/it]Epoch: 12, G: 167.2987, D: 167.2759:   2%|▏         | 13/600 [04:34<3:30:32, 21.52s/it]Epoch: 13, G: 242.8101, D: 242.7867:   2%|▏         | 13/600 [04:54<3:30:32, 21.52s/it]Epoch: 13, G: 242.8101, D: 242.7867:   2%|▏         | 14/600 [04:55<3:29:14, 21.42s/it]Epoch: 14, G: 258.1285, D: 258.1054:   2%|▏         | 14/600 [05:17<3:29:14, 21.42s/it]Epoch: 14, G: 258.1285, D: 258.1054:   2%|▎         | 15/600 [05:18<3:33:01, 21.85s/it]Epoch: 15, G: 243.4969, D: 243.4740:   2%|▎         | 15/600 [05:38<3:33:01, 21.85s/it]Epoch: 15, G: 243.4969, D: 243.4740:   3%|▎         | 16/600 [05:39<3:31:39, 21.75s/it]Epoch: 16, G: 255.1596, D: 255.1368:   3%|▎         | 16/600 [06:00<3:31:39, 21.75s/it]Epoch: 16, G: 255.1596, D: 255.1368:   3%|▎         | 17/600 [06:02<3:33:08, 21.94s/it]Epoch: 17, G: 249.7290, D: 249.7062:   3%|▎         | 17/600 [06:22<3:33:08, 21.94s/it]Epoch: 17, G: 249.7290, D: 249.7062:   3%|▎         | 18/600 [06:23<3:31:39, 21.82s/it]Epoch: 18, G: 268.2851, D: 268.2614:   3%|▎         | 18/600 [06:42<3:31:39, 21.82s/it]Epoch: 18, G: 268.2851, D: 268.2614:   3%|▎         | 19/600 [06:43<3:25:48, 21.25s/it]Epoch: 19, G: 260.7808, D: 260.7578:   3%|▎         | 19/600 [07:02<3:25:48, 21.25s/it]Epoch: 19, G: 260.7808, D: 260.7578:   3%|▎         | 20/600 [07:03<3:21:19, 20.83s/it]Epoch: 20, G: 212.6388, D: 212.6163:   3%|▎         | 20/600 [07:24<3:21:19, 20.83s/it]Epoch: 20, G: 212.6388, D: 212.6163:   4%|▎         | 21/600 [07:25<3:24:28, 21.19s/it]Epoch: 21, G: 214.1786, D: 214.1559:   4%|▎         | 21/600 [07:46<3:24:28, 21.19s/it]Epoch: 21, G: 214.1786, D: 214.1559:   4%|▎         | 22/600 [07:47<3:26:18, 21.42s/it]Epoch: 22, G: 204.9170, D: 204.8943:   4%|▎         | 22/600 [08:08<3:26:18, 21.42s/it]Epoch: 22, G: 204.9170, D: 204.8943:   4%|▍         | 23/600 [08:08<3:26:08, 21.44s/it]Epoch: 23, G: 392.8503, D: 392.8276:   4%|▍         | 23/600 [08:29<3:26:08, 21.44s/it]Epoch: 23, G: 392.8503, D: 392.8276:   4%|▍         | 24/600 [08:30<3:25:54, 21.45s/it]Run COT-414 received abort signal. Exiting
Shutting down background jobs, please wait a moment...
Done!
Waiting for the remaining 3 operations to synchronize with Neptune. Do not kill this process.
All 3 operations synced, thanks for waiting!
Explore the metadata in the Neptune app:
https://app.neptune.ai/kohmann/COTGAN/e/COT-414
/var/slurm_spool/job17129675/slurm_script: line 32: 193436 Terminated              python3 trainer.py --model cotgan --n_epochs 600 --batch_size 64 --l_rate 0.01 --l_rate_g 0.01 --use_opt_scheduler True --use_bn False --reg_lam 0.01 --sinkhorn_eps 0.8 --dataset twosolitons --dx 120 --dt 30 --trainset_size 1920 --testset_size 1920 --gen_rnn_num_layers 2 --gen_rnn_hidden_dim 256 --dis_rnn_num_layers 2 --dis_rnn_hidden_dim 64 --hidden_dim 256 --num_hidden_layers 4 --Z_dim 10 --J_dim 32 --device cuda
